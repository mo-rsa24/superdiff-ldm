# This sweep searches for the best LR, WD, and model size when
# overfitting on 32 images.

program: run/ldm.py
method: random
metric:
  name: sample_diversity/metrics/pairwise_mse_mean
  goal: maximize

parameters:
  # --- Varied Hyperparameters (What we are searching for) ---
  lr:
    distribution: log_uniform_values
    min: 1e-5
    max: 5e-4
  weight_decay:
    distribution: uniform
    min: 0.0
    max: 0.1
  ldm_base_ch:
    values: [96, 128]

  # --- Fixed Parameters (The context for this experiment) ---
  task:
    value: "PNEUMONIA"
  overfit_k:
    value: 32 # Set the number of samples to overfit on
  overfit_one:
    value: false
  epochs:
    value: 1500
  log_every:
    value: 50
  sample_every:
    value: 10
  sample_batch_size:
    value: 16 # Sample a 4x4 grid
  wandb:
    value: 1

program: run/ldm.py
method: random
metric:
  name: sample_diversity/metrics/pairwise_mse_mean
  goal: maximize

parameters:
  lr:
    distribution: log_uniform_values
    min: 0.00001
    max: 0.0005
  weight_decay:
    distribution: uniform
    min: 0.0
    max: 0.1
  ldm_base_ch:
    values: [96, 128]

  # --- Fixed Parameters (The context for this experiment) ---
  task:
    value: "TB"
  overfit_k:
    value: 16
  overfit_one:
    value: false
  epochs:
    value: 50
  log_every:
    value: 5
  sample_every:
    value: 5
  sample_batch_size:
    value: 16
  wandb:
    value: 1 # This is passed as an env var to the slurm script
  data_root:
    value: "/datasets/mmolefe/cleaned" # Use the absolute path
  ae_ckpt_path:
    value: "runs/ae_tb_full_kl_1.0e-5_zchannels_3/20251003-125631/ckpts/last.flax"
  ae_config_path:
    value: "runs/ae_tb_full_kl_1.0e-5_zchannels_3/20251003-125631/run_meta.json"
  latent_scale_factor:
    value: 1.951791